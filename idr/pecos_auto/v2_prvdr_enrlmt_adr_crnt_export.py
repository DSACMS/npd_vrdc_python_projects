"""
==========
V2_PRVDR_ENRLMT_ADR_CRNT IDR Export (Auto-Generated)
==========

Auto-generated IDROutputter implementation for IDRC_PRD.CMS_VDM_VIEW_MDCR_PRD.V2_PRVDR_ENRLMT_ADR_CRNT

Table Type: VIEW
Columns: 29
Generated: 2025-11-04 00:46:08
Source Pattern: %PRVDR_ENRLMT%

This script provides a complete IDROutputter subclass that exports all columns
from the table in their original Snowflake order. You can customize the
getSelectQuery() method to add WHERE clauses, JOINs, or modify column selection.

Usage:
    # In a Snowflake notebook environment:
    exporter = V2PrvdrEnrlmtAdrCrntExporter()
    exporter.do_idr_output()
"""

# Import python packages
import pandas as pd
from datetime import datetime

# Import the IDROutputter base class
try:
    from IDROutputter import IDROutputter
except ImportError:
    print("Loading IDROutputter from previous cell or add proper import path")


class V2PrvdrEnrlmtAdrCrntExporter(IDROutputter):
    """
    Exports V2_PRVDR_ENRLMT_ADR_CRNT data using IDROutputter base class.
    
    Auto-generated from table metadata. Customize as needed for your specific requirements.
    
    Table: IDRC_PRD.CMS_VDM_VIEW_MDCR_PRD.V2_PRVDR_ENRLMT_ADR_CRNT (VIEW)
    Columns: 29
    """
    
    # Class properties
    version_number: str = "v01"
    file_name_stub: str = "v2_prvdr_enrlmt_adr_crnt_idr_export"
    
    def getSelectQuery(self) -> str:
        """
        Returns the SELECT query for V2_PRVDR_ENRLMT_ADR_CRNT export.
        
        Includes all 29 columns in their original Snowflake order.
        Customize this method to add WHERE clauses, JOINs, or modify column selection.
        """
        return """SELECT
                PRVDR_ENRLMT_ID, -- TEXT(15): A UNIQUE VALUE GENERATED BY THE PROVIDER ENROLLMENT, CHAIN AND OWNERSHIP SYSTEM (PECOS) TO IDENTIFY A PROVIDER'S ENROLLMENT APPLICATION. ALL ENROLLMENT-LEVEL INFORMATION (E.G., ENROLLMENT TYPE, ENROLLMENT STATE, PROVIDER SPECIALTY AND REASSIGNMENT OF BENEFITS) IS LINKED THROUGH THE ENROLLMENT ID.
                ADR_TYPE_CD, -- TEXT(2): AN INTEGRATED DATA REPOSITORY (IDR) DERIVED CODE TO IDENTIFY THE PROVIDER'S ADDRESS TYPE.REFERENCE TABLE: ADR_TYPE_CD
                ADR_TYPE_DESC, -- TEXT(500): A DESCRIPTION OF A CODE IDENTIFYING AN ADDRESS TYPE.
                PRVDR_ENRLMT_ADR_BGN_DT, -- DATE: A DATE IDENTIFYING THE EFFECTIVE DATE FOR THIS VERSION OF THE PROVIDER ENROLLMENT IDENTIFIER'S ADDRESS.
                LINE_1_ADR, -- TEXT(55): A FIRST LINE OF AN ADDRESS ASSOCIATED WITH A BENEFICIARY, PROVIDER, OR CLAIM.  
                LINE_2_ADR, -- TEXT(55): A SECOND LINE OF AN ADDRESS ASSOCIATED WITH A BENEFICIARY, PROVIDER, OR CLAIM.  THIS ADDRESS LINE IS OPTIONAL AND USED TO INDICATE THE POST OFFICE BOX, SUITE NUMBER, APARTMENT NUMBER, ETC.
                ADR_CITY_NAME, -- TEXT(40): A NAME OF THE CITY ASSOCIATED WITH A FIVE-DIGIT ZIP CODE DEFINED BY THE UNITED STATES POSTAL SERVICE (USPS).
                GEO_USPS_STATE_CD, -- TEXT(2): A CODE IDENTIFYING A TWO-CHARACTER ALPHABETIC ABBREVIATION FOR A STATE IN THE UNITED STATES AS DEFINED BY UNITED STATES POSTAL SERVICE (USPS) ASSOCIATED WITH A BENEFICIARY, PROVIDER, OR CLAIM ADDRESS.REFERENCE TABLE:  GEO_USPS_STATE_CD
                OTHR_LCTN_TXT, -- TEXT(40): A FREE FORM AREA THAT CONTAINS THE TEXT PROVIDED BY THE SOURCE FOR THE STATE ASSOCIATED WITH A BENEFICIARY, PROVIDER, OR CLAIM ADDRESS. 
                ZIP5_CD, -- TEXT(5): A FIVE-DIGIT ZIP CODE DEFINED BY THE UNITED STATES POSTAL SERVICE (USPS) THAT IDENTIFIES A DESTINATION POST OFFICE OR  DELIVERY AREA ASSOCIATED WITH A BENEFICIARY, PROVIDER, OR CLAIM ADDRESS.REFERENCE TABLE:  GEO_ZIP5_CD
                ZIP4_CD, -- TEXT(4): A FOUR-DIGIT ZIP CODE EXTENSION DEFINED BY THE UNITED STATES POSTAL SERVICE (USPS) THAT REPRESENTS A SPECIFIC DELIVERY ROUTE WITHIN A DELIVERY AREA ASSOCIATED WITH A BENEFICIARY, PROVIDER, OR CLAIM ADDRESS.REFERENCE TABLE:  GEO_ZIP9_CD
                OTHR_ZIP_CD_TXT, -- TEXT(20): A FREE FORM AREA THAT CONTAINS THE TEXT PROVIDED BY THE SOURCE FOR THE ZIP CODE ASSOCIATED WITH A BENEFICIARY, PROVIDER, OR CLAIM ADDRESS. 
                GEO_SK, -- NUMBER(38): A NUMERIC SURROGATE KEY THAT IS INDICATIVE OF A PARTICULAR GEOGRAPHICAL LOCATION.
                CNTRY_CD, -- TEXT(2): A CODE IDENTIFYING A COUNTRY ASSOCIATED WITH A BENEFICIARY, PROVIDER, OR CLAIM ADDRESS AS ASSIGNED BY THE INTERNATIONAL ORGANIZATION FOR STANDARDIZATION (ISO).REFERENCE TABLE: GEO_CNTRY_CD
                PRVDR_ENRLMT_ADR_END_DT, -- DATE: A DATE IDENTIFYING THE TERMINATION DATE FOR THIS VERSION OF THE PROVIDER ENROLLMENT IDENTIFIER'S ADDRESS.
                IDR_DRVD_ENRLMT_ADR_END_DT_SW, -- TEXT(1): AN INDICATOR THAT IDENTIFIES IF THE INTEGRATED DATA REPOSITORY (IDR) DERIVED THE ENROLLMENT ADDRESS END DATE.  IF OVERLAPPING DATES ARE RECEIVED FROM THE PROVIDER ENROLLMENT, CHAIN, AND OWNERSHIP SYSTEM (PECOS) SOURCE SYSTEM, THE IDR WILL DERIVE THE EXPIRATION DATE SO NO DATES OVERLAP. OR, IF THERE ARE TWO OR MORE ROWS THAT CONTAIN A DIFFERENT EXPIRATION DATE, THE IDR WILL USE THE MOST RECENT EXPIRATION DATE FOR THAT PRIMARY KEY.

VALID VALUES:
Y = PROVIDER LICENSE EXPIRATION DATE IS DERIVED
N = PROVIDER LICENSE EXPIRATION DATE IS NOT DERIVED
                ENRLMT_ADR_NAME, -- TEXT(35): THE BUSINESS LOCATION NAME STORED WITH THE MAILING ADDRESS FOR THE PROVIDER ENROLLMENT.
                ENRLMT_ADR_FRGN_CD, -- TEXT(1): INDICATES WHETHER THE ADDRESS IS A FOREIGN ADDRESS.

VALID VALUES:
F = FOREIGN
D = DOMESTIC
                ENRLMT_ADR_FRGN_DESC, -- TEXT(24): A DESCRIPTION INDICATING IF THE ADDRESS IS A FOREIGN ADDRESS.
                ENRLMT_ADR_FRGN_STATE_NAME, -- TEXT(30): NAME OF THE STATE USED WITH THE FOREIGN ADDRESS.
                ENRLMT_ADR_FRGN_PSTL_CD, -- TEXT(20): POSTAL CODE OF THE FOREIGN ADDRESS.
                ENRLMT_ADR_TEL_NUM, -- NUMBER(20): TELEPHONE NUMBER FOR THE PROVIDER ENROLLMENT ADDRESS.
                ENRLMT_ADR_FAX_NUM, -- NUMBER(20): FAX NUMBER FOR THE PROVIDER ENROLLMENT ADDRESS.
                ENRLMT_EMAIL_ADR, -- TEXT(80): EMAIL ADDRESS FOR THE PROVIDER ENROLLMENT ADDRESS.
                IDR_INSRT_TS, -- TIMESTAMP_NTZ: THE SYSTEM DATE AND TIME ASSIGNED BY THE INTEGRATED DATA REPOSITORY (IDR) WHILE PERFORMING AN INSERT OPERATION.
                IDR_UPDT_TS, -- TIMESTAMP_NTZ: THE SYSTEM DATE AND TIME ASSIGNED BY THE INTEGRATED DATA REPOSITORY (IDR) WHEN UPDATES ARE MADE TO ANY NON-PRIMARY KEY COLUMN.
                META_SRC_SK, -- NUMBER(38): A UNIQUE NUMERIC VALUE ASSIGNED BY THE INTEGRATED DATA REPOSITORY (IDR) USED TO IDENTIFY THE SPECIFIC SOURCE OF THE DATA WHEN A ROW IS LOADED INTO THE IDR.REFERENCE TABLE: V2_MDCR_META_DCTNRY_SRC
                META_SRC_PRCSG_ID, -- NUMBER(38): A VALUE ASSIGNED BASED ON A BATCH IDENTIFICATION IN ORDER TO TRACE IT BACK TO ITS ORIGINAL SOURCE. IT WILL ONLY BE POPULATED WHEN A RECORD IS INSERTED.
                META_LTST_SRC_PRCSG_ID -- NUMBER(38): A VALUE ASSIGNED BASED ON A BATCH IDENTIFICATION IN ORDER TO TRACE IT BACK TO ITS ORIGINAL SOURCE. IT WILL ONLY BE POPULATED WHEN A RECORD IS SUBSEQUENTLY UPDATED.
            FROM IDRC_PRD.CMS_VDM_VIEW_MDCR_PRD.V2_PRVDR_ENRLMT_ADR_CRNT"""


if __name__ == '__main__':
    # Execute the export using the IDROutputter framework
    exporter = V2PrvdrEnrlmtAdrCrntExporter()
    exporter.do_idr_output()

# To download use: 
# snowsql -c cms_idr -q "GET @~/ file://. PATTERN='.*.csv';"
# Or look in ../misc_scripts/ for download_and_merge_all_snowflake_csv.sh
