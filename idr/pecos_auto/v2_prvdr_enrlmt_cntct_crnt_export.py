"""
==========
V2_PRVDR_ENRLMT_CNTCT_CRNT IDR Export (Auto-Generated)
==========

Auto-generated IDROutputter implementation for IDRC_PRD.CMS_VDM_VIEW_MDCR_PRD.V2_PRVDR_ENRLMT_CNTCT_CRNT

Table Type: VIEW
Columns: 27
Generated: 2025-11-04 00:46:08
Source Pattern: %PRVDR_ENRLMT%

This script provides a complete IDROutputter subclass that exports all columns
from the table in their original Snowflake order. You can customize the
getSelectQuery() method to add WHERE clauses, JOINs, or modify column selection.

Usage:
    # In a Snowflake notebook environment:
    exporter = V2PrvdrEnrlmtCntctCrntExporter()
    exporter.do_idr_output()
"""

# Import python packages
import pandas as pd
from datetime import datetime

# Import the IDROutputter base class
try:
    from IDROutputter import IDROutputter
except ImportError:
    print("Loading IDROutputter from previous cell or add proper import path")


class V2PrvdrEnrlmtCntctCrntExporter(IDROutputter):
    """
    Exports V2_PRVDR_ENRLMT_CNTCT_CRNT data using IDROutputter base class.
    
    Auto-generated from table metadata. Customize as needed for your specific requirements.
    
    Table: IDRC_PRD.CMS_VDM_VIEW_MDCR_PRD.V2_PRVDR_ENRLMT_CNTCT_CRNT (VIEW)
    Columns: 27
    """
    
    # Class properties
    version_number: str = "v01"
    file_name_stub: str = "v2_prvdr_enrlmt_cntct_crnt_idr_export"
    
    def getSelectQuery(self) -> str:
        """
        Returns the SELECT query for V2_PRVDR_ENRLMT_CNTCT_CRNT export.
        
        Includes all 27 columns in their original Snowflake order.
        Customize this method to add WHERE clauses, JOINs, or modify column selection.
        """
        return """SELECT
                PRVDR_ENRLMT_ID, -- TEXT(15): A UNIQUE VALUE GENERATED BY THE PROVIDER ENROLLMENT, CHAIN AND OWNERSHIP SYSTEM (PECOS) TO IDENTIFY A PROVIDER'S ENROLLMENT APPLICATION. ALL ENROLLMENT-LEVEL INFORMATION (E.G., ENROLLMENT TYPE, ENROLLMENT STATE, PROVIDER SPECIALTY AND REASSIGNMENT OF BENEFITS) IS LINKED THROUGH THE ENROLLMENT ID.
                PRVDR_ENRLMT_CNTCT_TYPE_CD, -- TEXT(2): A CODE IDENTIFYING THE TYPE OF CONTACT PERSON. REFERENCE TABLE:  PRVDR_PECOS_ENRLMT_CNTCT_TYPE_CD
                PRVDR_ENRLMT_CNTCT_TYPE_DESC, -- TEXT(1000): A DESCRIPTION OF A TYPE OF PROVIDER CONTACT FOR AN ENROLLMENT.
                PRVDR_ENRLMT_CNTCT_OTHR_TYPE_TXT, -- TEXT(60): A DESCRIPTION OF THE CONTACT TYPE IF THE CONTACT TYPE IS OTHER.
                CNTCT_FIRST_NAME, -- TEXT(35): A PROVIDER PERSONAL FIRST NAME THAT IDENTIFIES THE INDIVIDUAL THAT PRECEDES THE LAST NAME.
                CNTCT_MDL_NAME, -- TEXT(20): A PROVIDER PERSONAL MIDDLE NAME THAT IDENTIFIES THE INDIVIDUAL THAT IS PLACED AFTER THE FIRST NAME AND BEFORE THE SURNAME
                CNTCT_LAST_NAME, -- TEXT(35): A PROVIDER PERSONAL SURNAME OR LAST NAME
                IDR_DRVD_PRVDR_ENRLMT_CNTCT_BGN_DT, -- DATE: A DATE DERIVED BY THE INTEGRATED DATA REPOSITORY (IDR) TO INDICATE THE EFFECTIVE DATE OF  THE CONTACT INFORMATION IN THE PROVIDER ENROLLMENT CHAIN AND OWNERSHIP SYSTEM(PECOS). THE IDR IDR DERIVED PROVIDER ENROLLMENT CONTACT BEGIN DATE IS SET AT ONE DAY PRIOR TO THE NEXT RECORDS TERMINATION DATE.  IF THIS IS THE FIRST RECORD OR ONLY RECORD FOR THE CONTACT INFORMATION, THE EFFECTIVE DATE WILL BE SET TO 01/01/1000.
                PRVDR_ENRLMT_CNTCT_END_DT, -- DATE: A DATE IDENTIFYING THE TERMINATION DATE FOR THIS VERSION OF THE CONTACT'S INFORMATION.
                LINE_1_ADR, -- TEXT(55): A FIRST LINE OF AN ADDRESS ASSOCIATED WITH A BENEFICIARY, PROVIDER, OR CLAIM.
                LINE_2_ADR, -- TEXT(55): A SECOND LINE OF AN ADDRESS ASSOCIATED WITH A BENEFICIARY, PROVIDER, OR CLAIM.  THIS ADDRESS LINE IS OPTIONAL AND USED TO INDICATE THE POST OFFICE BOX, SUITE NUMBER, APARTMENT NUMBER, ETC.
                ADR_CITY_NAME, -- TEXT(40): A NAME OF THE CITY ASSOCIATED WITH A FIVE-DIGIT ZIP CODE DEFINED BY THE UNITED STATES POSTAL SERVICE (USPS).
                GEO_USPS_STATE_CD, -- TEXT(2): A CODE IDENTIFYING A TWO-CHARACTER ALPHABETIC ABBREVIATION FOR A STATE IN THE UNITED STATES AS DEFINED BY UNITED STATES POSTAL SERVICE (USPS) ASSOCIATED WITH A BENEFICIARY, PROVIDER, OR CLAIM ADDRESS.

REFERENCE TABLE:  GEO_USPS_STATE_CD
                OTHR_LCTN_TXT, -- TEXT(40): A FREE FORM AREA THAT CONTAINS THE TEXT PROVIDED BY THE SOURCE FOR THE STATE ASSOCIATED WITH A BENEFICIARY, PROVIDER, OR CLAIM ADDRESS.
                ZIP5_CD, -- TEXT(5): A FIVE-DIGIT ZIP CODE DEFINED BY THE UNITED STATES POSTAL SERVICE (USPS) THAT IDENTIFIES A DESTINATION POST OFFICE OR  DELIVERY AREA ASSOCIATED WITH A BENEFICIARY, PROVIDER, OR CLAIM ADDRESS.

REFERENCE TABLE:  GEO_ZIP5_CD
                ZIP4_CD, -- TEXT(4): A FOUR-DIGIT ZIP CODE EXTENSION DEFINED BY THE UNITED STATES POSTAL SERVICE (USPS) THAT REPRESENTS A SPECIFIC DELIVERY ROUTE WITHIN A DELIVERY AREA ASSOCIATED WITH A BENEFICIARY, PROVIDER, OR CLAIM ADDRESS.

REFERENCE TABLE:  GEO_ZIP9_CD
                OTHR_ZIP_CD_TXT, -- TEXT(20): A FREE FORM AREA THAT CONTAINS THE TEXT PROVIDED BY THE SOURCE FOR THE ZIP CODE ASSOCIATED WITH A BENEFICIARY, PROVIDER, OR CLAIM ADDRESS.
                GEO_SK, -- NUMBER(38): A NUMERIC SURROGATE KEY THAT IS INDICATIVE OF A PARTICULAR GEOGRAPHICAL LOCATION.
                CNTRY_CD, -- TEXT(2): A CODE IDENTIFYING A COUNTRY ASSOCIATED WITH A BENEFICIARY, PROVIDER, OR CLAIM ADDRESS AS ASSIGNED BY THE INTERNATIONAL ORGANIZATION FOR STANDARDIZATION (ISO).

REFERENCE TABLE: GEO_CNTRY_CD
                ENRLMT_CNTCT_EMAIL_ADR, -- TEXT(80): THE CONTACT'S ELECTRONIC MAIL ADDRESS USED TO ELECTRONICALLY COMMUNICATE WITH THE CONTACT.
                ENRLMT_CNTCT_TEL_NUM, -- TEXT(20): A SEQUENCE OF NUMBERS THAT IDENTIFIES A PARTICULAR TELEPHONE AND THAT MUST BE DIALED FOR THE CALLER TO CONNECT TO THE TELEPHONE OF THE CONTACT.
                ENRLMT_CNTCT_FAX_NUM, -- TEXT(20): A SEQUENCE OF NUMBERS THAT IDENTIFIES THE CONTACT'S TELEPHONE DESIGNED TO RECEIVE AN IMAGE OR DOCUMENT TRANSMITTED IN DIGITIZED ELECTRONIC FORM.
                IDR_INSRT_TS, -- TIMESTAMP_NTZ: THE SYSTEM DATE AND TIME ASSIGNED BY THE INTEGRATED DATA REPOSITORY (IDR) WHILE PERFORMING AN INSERT OPERATION.
                IDR_UPDT_TS, -- TIMESTAMP_NTZ: THE SYSTEM DATE AND TIME ASSIGNED BY THE INTEGRATED DATA REPOSITORY (IDR) WHEN UPDATES ARE MADE TO ANY NON-PRIMARY KEY COLUMN.
                META_SRC_SK, -- NUMBER(38): A UNIQUE NUMERIC VALUE ASSIGNED BY THE INTEGRATED DATA REPOSITORY (IDR) USED TO IDENTIFY THE SPECIFIC SOURCE OF THE DATA WHEN A ROW IS LOADED INTO THE IDR.

 REFERENCE TABLE: V2_MDCR_META_DCTNRY_SRC
                META_SRC_PRCSG_ID, -- NUMBER(38): A VALUE ASSIGNED BASED ON A BATCH IDENTIFICATION IN ORDER TO TRACE IT BACK TO ITS ORIGINAL SOURCE. IT WILL ONLY BE POPULATED WHEN A RECORD IS INSERTED.
                META_LTST_SRC_PRCSG_ID -- NUMBER(38): A VALUE ASSIGNED BASED ON A BATCH IDENTIFICATION IN ORDER TO TRACE IT BACK TO ITS ORIGINAL SOURCE. IT WILL ONLY BE POPULATED WHEN A RECORD IS SUBSEQUENTLY UPDATED.
            FROM IDRC_PRD.CMS_VDM_VIEW_MDCR_PRD.V2_PRVDR_ENRLMT_CNTCT_CRNT"""


if __name__ == '__main__':
    # Execute the export using the IDROutputter framework
    exporter = V2PrvdrEnrlmtCntctCrntExporter()
    exporter.do_idr_output()

# To download use: 
# snowsql -c cms_idr -q "GET @~/ file://. PATTERN='.*.csv';"
# Or look in ../misc_scripts/ for download_and_merge_all_snowflake_csv.sh
