"""
==========
V2_PRVDR_ENRLMT_PRCTC_LCTN_CRNT IDR Export (Auto-Generated)
==========

Auto-generated IDROutputter implementation for IDRC_PRD.CMS_VDM_VIEW_MDCR_PRD.V2_PRVDR_ENRLMT_PRCTC_LCTN_CRNT

Table Type: VIEW
Columns: 44
Generated: 2025-11-04 01:29:56
Source Pattern: %PRVDR_ENRLMT%

This script provides a complete IDROutputter subclass that exports all columns
from the table in their original Snowflake order. You can customize the
getSelectQuery() method to add WHERE clauses, JOINs, or modify column selection.

Usage:
    # In a Snowflake notebook environment:
    exporter = V2PrvdrEnrlmtPrctcLctnCrntExporter()
    exporter.do_idr_output()
"""

# Import python packages
import pandas as pd
from datetime import datetime

# Import the IDROutputter base class
try:
    from IDROutputter import IDROutputter
except ImportError:
    print("Loading IDROutputter from previous cell or add proper import path")


class V2PrvdrEnrlmtPrctcLctnCrntExporter(IDROutputter):
    """
    Exports V2_PRVDR_ENRLMT_PRCTC_LCTN_CRNT data using IDROutputter base class.
    
    Auto-generated from table metadata. Customize as needed for your specific requirements.
    
    Table: IDRC_PRD.CMS_VDM_VIEW_MDCR_PRD.V2_PRVDR_ENRLMT_PRCTC_LCTN_CRNT (VIEW)
    Columns: 44
    """
    
    # Class properties
    version_number: str = "v01"
    file_name_stub: str = "v2_prvdr_enrlmt_prctc_lctn_crnt_idr_export"
    
    def getSelectQuery(self) -> str:
        """
        Returns the SELECT query for V2_PRVDR_ENRLMT_PRCTC_LCTN_CRNT export.
        
        Includes all 44 columns in their original Snowflake order.
        Customize this method to add WHERE clauses, JOINs, or modify column selection.
        """
        return """SELECT
                PRVDR_ENRLMT_ID, -- TEXT(15): A UNIQUE VALUE GENERATED BY THE PROVIDER ENROLLMENT, CHAIN AND OWNERSHIP SYSTEM (PECOS) TO IDENTIFY A PROVIDER'S ENROLLMENT APPLICATION. ALL ENROLLMENT-LEVEL INFORMATION (E.G., ENROLLMENT TYPE, ENROLLMENT STATE, PROVIDER SPECIALTY AND REASSIGNMENT OF BENEFITS) IS LINKED THROUGH THE ENROLLMENT ID.
                PRCTC_LCTN_SK, -- NUMBER(20): UNIQUE NUMBER GENERATED BY PROVIDER ENROLLMENT, CHAIN AND OWNERSHIP SYSTEM (PECOS) TO MAKE THE PRACTICE LOCATION ROW UNIQUE.
                PRCTC_LCTN_NAME, -- TEXT(35): NAME OF THE LOCATION WHERE HEALTH CARE SERVICES ARE RENDERED.
                PRCTC_LCTN_STUS_CD, -- TEXT(1): AN INDICATOR THAT IDENTIFIES WHETHER THE PRACTICE IS THE CURRENT LOCATION. VALID VALUES: C = CURRENT H = HISTORY
                PRCTC_LCTN_STUS_DESC, -- TEXT(24): A DESCRIPTION OF A CODE THAT IDENTIFIES WHETHER THE PRACTICE IS THE CURRENT LOCATION.
                PRCTC_LCTN_PRMRY_SW, -- TEXT(1): AN INDICATOR THAT IDENTIFIES WHETHER THE PRACTICE LOCATION IS PRIMARY OR NOT. VALID VALUES: Y = PRIMARY PRACTICE LOCATION N = NOT THE PRIMARY PRACTICE LOCATION
                PRCTC_LCTN_OWNRSHP_CD, -- TEXT(1): A UNIQUE VALUE THAT IDENTIFIES WHETHER PRACTICE LOCATION IS OWNED OR LEASED. VALID VALUES: Y = PRACTICE LOCATION IS OWNED N = PRACTICE LOCATION IS NOT OWNED 9 = USER DID NOT SELECT AN OPTION
                PRCTC_LCTN_FST_PTNT_VISIT_DT, -- DATE: THE VISIT DATE OF THE FIRST MEDICARE PATIENT AT THIS PRACTICE LOCATION.
                PRCTC_LCTN_HOSP_SW, -- TEXT(1): AN INDICATOR THAT IDENTIFIES WHETHER THE PRACTICE LOCATION IS THE MAIN OR PRIMARY HOSPITAL LOCATION. VALID VALUES: Y = PRIMARY HOSPITAL LOCATION N = NOT THE PRIMARY HOSPITAL LOCATION 9 = USER DID NOT SELECT AN OPTION
                PRCTC_LCTN_RTRMT_SW, -- TEXT(1): AN INDICATOR THAT IDENTIFIES WHETHER THE PRACTICE LOCATION IS A RETIREMENT/ASSISTED LIVING COMMUNITY. VALID VALUES: Y = RETIREMENT/ASSISTED LIVING COMMUNITY N = NOT A RETIREMENT/ASSISTED LIVING COMMUNITY 9 = USER DID NOT SELECT AN OPTION
                PRCTC_LCTN_GRP_CLNC_SW, -- TEXT(1): AN INDICATOR THAT IDENTIFIES WHETHER THE PRACTICE LOCATION IS A GROUP PRACTICE OFFICE/CLINIC. VALID VALUES: Y = GROUP PRACTICE OFFICE/CLINIC LOCATION N = NOT A GROUP PRACTICE OFFICE/CLINIC LOCATION 9 = USER DID NOT SELECT AN OPTION
                PRCTC_LCTN_HLTH_CARE_FAC_SW, -- TEXT(1): AN INDICATOR THAT IDENTIFIES WHETHER THE PRACTICE LOCATION IS A HEALTH CARE FACILITY OTHER THAN WHAT IS LISTED ON THE FORM. VALID VALUES: Y = IS A HEALTH CARE FACILITY OTHER THAN WHAT IS LISTED ON THE FORM N = NOT A HEALTH CARE FACILITY OTHER THAN WHAT IS LISTED ON THE FORM 9 = USER DID NOT SELECT AN OPTION
                PRCTC_LCTN_PRVT_OFC_SW, -- TEXT(1): AN INDICATOR THAT IDENTIFIES WHETHER THE OCCUPATIONAL/PHYSICAL THERAPISTS PRIVATE OFFICE SPACE IS USED EXCLUSIVELY FOR THEIR PRIVATE PRACTICE. VALID VALUES: Y = THE PRIVATE OFFICE SPACE IS USED EXCLUSIVELY FOR PRIVATE PRACTICE N = NOT USED EXCLUSIVELY FOR PRIVATE PRACTICE 9 = USER DID NOT SELECT AN OPTION
                PRCTC_LCTN_HHA_BRNCH_SW, -- TEXT(1): AN INDICATOR THAT IDENTIFIES WHETHER THE PRACTICE LOCATION IS A HOME HEALTH AGENCY (HHA) BRANCH. (ONLY APPLICABLE FOR HOSPITALS AND HHAS) VALID VALUES: Y = PRACTICE LOCATION IS AN HHA N = PRACTICE LOCATION IS NOT A HHA
                PRCTC_LCTN_PSYCH_SW, -- TEXT(1): AN INDICATOR THAT IDENTIFIES WHETHER THE PRACTICE LOCATION IS HOSPITAL PSYCHIATRIC UNIT. (ONLY APPLICABLE FOR HOSPITALS AND HHAS) VALID VALUES: Y = PRACTICE LOCATION IS HOSPITAL PSYCHIATRIC UNIT N = PRACTICE LOCATION IS NOT A HOSPITAL PSYCHIATRIC UNIT
                PRCTC_LCTN_REHAB_SW, -- TEXT(1): AN INDICATOR THAT IDENTIFIES WHETHER THE PRACTICE LOCATION IS HOSPITAL REHABILITATION UNIT. (ONLY APPLICABLE FOR HOSPITALS AND HHAS) VALID VALUES: Y = PRACTICE LOCATION IS HOSPITAL REHABILITATION UNIT N = PRACTICE LOCATION IS NOT A HOSPITAL REHABILITATION UNIT
                PRCTC_LCTN_HOSP_SB_UNIT_SW, -- TEXT(1): AN INDICATOR THAT IDENTIFIES WHETHER THE PRACTICE LOCATION HAS A SWING BED UNIT. VALID VALUES: Y = PRACTICE LOCATION HAS A SWING BED UNIT N = PRACTICE LOCATION DOES NOT HAVE A SWING BED UNIT
                PRCTC_LCTN_OPT_EXTNSN_SITE_SW, -- TEXT(1): AN INDICATOR THAT IDENTIFIES WHETHER THE PRACTICE LOCATION IS AN OUTPATIENT PHYSICAL THERAPY EXTENSION SITE. VALID VALUES: Y = PRACTICE LOCATION IS AN OUTPATIENT PHYSICAL THERAPY EXTENSION SITE. N = PRACTICE LOCATION IS NOT AN OUTPATIENT PHYSICAL THERAPY EXTENSION SITE.
                PRCTC_LCTN_AMRCN_DSBLTY_ACT_ACS_STD_SW, -- TEXT(1): AN INDICATOR THAT IDENTIFIES IF THE LOCATION MEETS THE AMERICANS WITH DISABILITIES ACT ACCESSIBILITY STANDARDS. VALID VALUES: Y = THIS LOCATION MEETS THE AMERICANS WITH DISABILITIES ACT ACCESSIBILITY STANDARDS N = THIS LOCATION DOES NOT MEET THE AMERICANS WITH DISABILITIES ACT ACCESSIBILITY STANDARDS
                PRCTC_LCTN_INDN_HLTH_SRVCS_SW, -- TEXT(1): AN INDICATOR THAT IDENTIFIES IF THE CONTRACTOR WAS FOR INDIAN HEALTH SERVICE. VALID VALUES: Y = YES, CONTRACTOR WAS FOR INDIAN HEALTH SERVICES N = NO, CONTRACTOR WAS NOT FOR INDIAN HEALTH SERVICES
                PRCTC_LCTN_OPRTN_OTHR_THAN_HLTH_CARE_SW, -- TEXT(1): AN INDICATOR THAT IDENTIFIES WHETHER THE LOCATION WAS FOR OPERATION OTHER THAN HEALTH CARE FOR EXAMPLE A GYM. VALID VALUES: Y = YES, LOCATION IS FOR SOMETHING OTHER THAN HEALTH CARE N = NO, LOCATION IF FOR HEALTH CARE
                PRCTC_LCTN_SOLE_MDPP_SUPLR_SW, -- TEXT(1): AN INDICATOR THAT IDENTIFIES WHETHER THE LOCATION WAS SOLELY MEDICARE DIABETES PREVENTION PROGRAM (MDPP) SUPPLIER. VALID VALUES: Y = YES, THE LOCATION WAS SOLELY FOR MDPP N = NO, THE LOCATION WAS NOT SOLELY FOR MDPP
                PRCTC_LCTN_ASC_SW, -- TEXT(1): AN INDICATOR THAT IDENTIFIES WHETHER THE PRACTICE LOCATION IS AN AMBULATORY SURGICAL CENTER. VALID VALUES: Y = PRACTICE LOCATION IS AN AMBULATORY SURGICAL CENTER N = PRACTICE LOCATION IS NOT AN AMBULATORY SURGICAL CENTER
                PRCTC_LCTN_HOME_BUSNS_ADMINV_SW, -- TEXT(1): AN INDICATOR THAT IDENTIFIES WHETHER THE PRACTICE LOCATION OF THE HOME/BUSINESS OFFICE IS FOR ADMINISTRATIVE USE ONLY. VALID VALUES: Y = PRACTICE LOCATION IS FOR ADMINISTRATIVE USE ONLY N = PRACTICE LOCATION IS NOT FOR ADMINISTRATIVE USE ONLY
                PRCTC_LCTN_HRSA_RVW_CMPLT_SW, -- TEXT(1): AN INDICATOR THAT IDENTIFIES WHETHER THE PRACTICE LOCATION WAS FROM HEALTH RESOURCES AND SERVICES ADMINISTRATION (HRSA) FILE AND WAS COMPLETED REVIEWED. VALID VALUES: Y = THE PRACTICE LOCATION WAS FROM HRSA AND COMPLETED REVIEW N = THE PRACTICE LOCATION WAS NOT FROM HRSA AND REVIEW NOT COMPLETED
                PRCTC_LCTN_IDTF_SW, -- TEXT(1): AN INDICATOR THAT IDENTIFIES WHETHER A PRACTICE LOCATION IS FOR AN INDEPENDENT DIAGNOSTIC TESTING FACILITY (IDTF). VALID VALUES:. Y = THE PRACTICE LOCATION IS FOR IDTF N = THE PRACTICE LOCATION IS NOT FOR AN IDTF
                PRCTC_LCTN_MN_PRMRY_HOSP_SW, -- TEXT(1): AN INDICATOR THAT IDENTIFIES WHETHER A PRACTICE LOCATION IS FOR THE MAIN PRIMARY HOSPITAL. VALID VALUES:. Y = THE PRACTICE LOCATION IS THE MAIN PRIMARY HOSPITAL N = THE PRACTICE LOCATION IS NOT THE MAIN PRIMARY HOSPITAL
                PRCTC_LCTN_PBD_SITE_SW, -- TEXT(1): AN INDICATOR THAT IDENTIFIES WHETHER THIS PRACTICE LOCATION IS A PROVIDER-BASED DEPARTMENT SITE. THE VALID VALUES: Y = PRACTICE LOCATION IS A PROVIDER-BASED DEPARTMENT SITE N = PRACTICE LOCATION IS NOT A PROVIDE-BASED DEPARTMENT SITE
                PRCTC_LCTN_PBD_TYPE_CD, -- TEXT(1): A UNIQUE VALUE UNIQUE THAT IDENTIFIES THE TYPE OF THE PROVIDER BASED DEPARTMENT. REFERENCE TABLE: PRVDR_PECOS_PRCTC_LCTN_PBD_TYPE_CD
                PRCTC_LCTN_PBD_TYPE_DESC, -- TEXT(1000): A DESCRIPTION OF A CODE INDICATING THE TYPE OF THE PROVIDER-BASED DEPARTMENT.
                PRCTC_LCTN_PRTBL_CD, -- TEXT(1): A UNIQUE VALUE THAT IDENTIFIES WHETHER THE ORGANIZATION FURNISHES HEALTH CARE SERVICES FROM A PORTABLE UNIT OR MOBILE FACILITY. VALID VALUES: P = PRACTICE LOCATION O = BASE OF OPERATIONS B = BOTH NULL
                PRCTC_LCTN_PRTBL_DESC, -- TEXT(24): A DESCRIPTION OF A CODE THAT IDENTIFIES WHETHER THE ORGANIZATION FURNISHES HEALTH CARE SERVICES FROM A PORTABLE UNIT OR MOBILE FACILITY.
                PRCTC_LCTN_HLTH_FAC_OTHR_TXT, -- TEXT(100): TYPE OF HEALTH CARE FACILITY THAT USES THIS PRACTICE LOCATION.
                PRCTC_LCTN_TEL_NUM, -- TEXT(20): A TELEPHONE NUMBER FOR THE PRACTICE LOCATION.
                PRCTC_LCTN_EMAIL_ADR, -- TEXT(80): AN EMAIL ADDRESS OF THE PRACTICE LOCATION.
                PRCTC_LCTN_FAX_NUM, -- TEXT(20): A FAX NUMBER OF THE PRACTICE LOCATION.
                PRCTC_LCTN_SNF_CD, -- TEXT(1): AN INDICATOR THAT IDENTIFIES WHETHER THIS PRACTICE LOCATION IS IDENTIFYING AS A SKILLED NURSING FACILITY (SNF). VALID VALUES: Y = PRACTICE LOCATION IS A SNF N = PRACTICE LOCATION IS NOT A SNF 9 = USER DID NOT SELECT AN OPTION
                PRCTC_LCTN_CDC_ORG_TXT, -- TEXT(30): THE DESCRIPTION FOR CENTERS FOR DISEASE CONTROL AND PREVENTION (CDC) ORGANIZATION THAT IS ASSOCIATED WITH THE LOCATION.
                PRCTC_LCTN_LTST_RSN_DESC, -- TEXT(55): TEXT THAT DESCRIBES THE REASONS FOR CHANGES TO AN ADDRESS THAT CORRESPOND A REASON CODE.
                IDR_INSRT_TS, -- TIMESTAMP_NTZ: THE SYSTEM DATE AND TIME ASSIGNED BY THE INTEGRATED DATA REPOSITORY (IDR) WHILE PERFORMING AN INSERT OPERATION.
                IDR_UPDT_TS, -- TIMESTAMP_NTZ: THE SYSTEM DATE AND TIME ASSIGNED BY THE INTEGRATED DATA REPOSITORY (IDR) WHEN UPDATES ARE MADE TO ANY NON-PRIMARY KEY COLUMN.
                META_SRC_SK, -- NUMBER(38): A UNIQUE NUMERIC VALUE ASSIGNED BY THE INTEGRATED DATA REPOSITORY (IDR) USED TO IDENTIFY THE SPECIFIC SOURCE OF THE DATA WHEN A ROW IS LOADED INTO THE IDR.REFERENCE TABLE: V2_MDCR_META_DCTNRY_SRC
                META_SRC_PRCSG_ID, -- NUMBER(38): A VALUE ASSIGNED BASED ON A BATCH IDENTIFICATION IN ORDER TO TRACE IT BACK TO ITS ORIGINAL SOURCE. IT WILL ONLY BE POPULATED WHEN A RECORD IS INSERTED.
                META_LTST_SRC_PRCSG_ID -- NUMBER(38): A VALUE ASSIGNED BASED ON A BATCH IDENTIFICATION IN ORDER TO TRACE IT BACK TO ITS ORIGINAL SOURCE. IT WILL ONLY BE POPULATED WHEN A RECORD IS SUBSEQUENTLY UPDATED.
            FROM IDRC_PRD.CMS_VDM_VIEW_MDCR_PRD.V2_PRVDR_ENRLMT_PRCTC_LCTN_CRNT"""


if __name__ == '__main__':
    # Execute the export using the IDROutputter framework
    exporter = V2PrvdrEnrlmtPrctcLctnCrntExporter()
    exporter.do_idr_output()

# To download use: 
# snowsql -c cms_idr -q "GET @~/ file://. PATTERN='.*.csv';"
# Or look in ../misc_scripts/ for download_and_merge_all_snowflake_csv.sh
