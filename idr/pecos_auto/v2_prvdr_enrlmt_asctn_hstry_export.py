"""
==========
V2_PRVDR_ENRLMT_ASCTN_HSTRY IDR Export (Auto-Generated)
==========

Auto-generated IDROutputter implementation for IDRC_PRD.CMS_VDM_VIEW_MDCR_PRD.V2_PRVDR_ENRLMT_ASCTN_HSTRY

Table Type: VIEW
Columns: 23
Generated: 2025-11-04 01:29:56
Source Pattern: %PRVDR_ENRLMT%

This script provides a complete IDROutputter subclass that exports all columns
from the table in their original Snowflake order. You can customize the
getSelectQuery() method to add WHERE clauses, JOINs, or modify column selection.

Usage:
    # In a Snowflake notebook environment:
    exporter = V2PrvdrEnrlmtAsctnHstryExporter()
    exporter.do_idr_output()
"""

# Import python packages
import pandas as pd
from datetime import datetime

# Import the IDROutputter base class
try:
    from IDROutputter import IDROutputter
except ImportError:
    print("Loading IDROutputter from previous cell or add proper import path")


class V2PrvdrEnrlmtAsctnHstryExporter(IDROutputter):
    """
    Exports V2_PRVDR_ENRLMT_ASCTN_HSTRY data using IDROutputter base class.
    
    Auto-generated from table metadata. Customize as needed for your specific requirements.
    
    Table: IDRC_PRD.CMS_VDM_VIEW_MDCR_PRD.V2_PRVDR_ENRLMT_ASCTN_HSTRY (VIEW)
    Columns: 23
    """
    
    # Class properties
    version_number: str = "v01"
    file_name_stub: str = "v2_prvdr_enrlmt_asctn_hstry_idr_export"
    
    def getSelectQuery(self) -> str:
        """
        Returns the SELECT query for V2_PRVDR_ENRLMT_ASCTN_HSTRY export.
        
        Includes all 23 columns in their original Snowflake order.
        Customize this method to add WHERE clauses, JOINs, or modify column selection.
        """
        return """SELECT
                PRVDR_ENRLMT_ID, -- TEXT(15): A UNIQUE VALUE GENERATED BY THE PROVIDER ENROLLMENT, CHAIN AND OWNERSHIP SYSTEM (PECOS) TO IDENTIFY A PROVIDER'S ENROLLMENT APPLICATION. ALL ENROLLMENT-LEVEL INFORMATION (E.G., ENROLLMENT TYPE, ENROLLMENT STATE, PROVIDER SPECIALTY AND REASSIGNMENT OF BENEFITS) IS LINKED THROUGH THE ENROLLMENT ID.
                PRVDR_PAC_ID, -- TEXT(10): A UNIQUE NUMERIC IDENTIFIER THAT IS ASSIGNED TO EACH INDIVIDUAL OR ORGANIZATION IN PROVIDER ENROLLMENT, CHAIN AND OWNERSHIP SYSTEM (PECOS). ALL ENTITY-LEVEL INFORMATION (E.G., TAX IDENTIFICATION NUMBERS AND ORGANIZATIONAL NAMES) IS LINKED THROUGH THE PAC ID. A PAC ID MAY BE ASSOCIATED WITH MULTIPLE ENROLLMENT IDS IF THE INDIVIDUAL OR ORGANIZATION ENROLLED MULTIPLE TIMES UNDER DIFFERENT CIRCUMSTANCES
                PRVDR_ENRLMT_ASCTN_ROLE_CD, -- TEXT(2): A CODE INDICATING THE PROVIDER'S OR SUPPLIER'S ASSOCIATION ROLE IN THE PROVIDER ENROLLMENT, CHAIN AND OWNERSHIP SYSTEM (PECOS).REFERENCE TABLE: PRVDR_PECOS_ENRLMT_ASCTN_ROLE_CD
                PRVDR_ENRLMT_ASCTN_ROLE_DESC, -- TEXT(100): A DESCRIPTION OF A CODE INDICATING THE PROVIDER'S OR SUPPLIERS ASSOCIATION ROLE IN THE PROVIDER ENROLLMENT, CHAIN AND OWNERSHIP SYSTEM (PECOS).
                PRVDR_ENRLMT_ASCTN_EFCTV_DT, -- DATE: A DATE INDICATING THE EFFECTIVE DATE OF THE ENROLLMENT ASSOCIATION IN THE PROVIDER ENROLLMENT, CHAIN, AND OWNERSHIP SYSTEM (PECOS).
                IDR_TRANS_EFCTV_TS, -- TIMESTAMP_NTZ: THE SYSTEM DATE AND TIME ASSIGNED BY THE INTEGRATED DATA REPOSITORY (IDR) IDENTIFYING WHEN A RECORD WAS LOADED.
                IDR_TRANS_OBSLT_TS, -- TIMESTAMP_NTZ: THE SYSTEM DATE AND TIME ASSIGNED BY THE INTEGRATED DATA REPOSITORY (IDR) WHEN A RECORD WAS LAST KNOWN TO BE PRESENT IN THE SOURCE. THE CURRENT VERSION OF A RECORD WILL BE SET TO 12/31/9999 00:00:00.
                IDR_LTST_TRANS_FLG, -- TEXT(1): AN INDICATOR ASSIGNED BY THE INTEGRATED DATA REPOSITORY (IDR) THAT IDENTIFIES WHICH TRANSACTION RECORD, BASED ON PRIMARY KEY, IS CONSIDERED TO REPRESENT THE MOST RECENT RECORD RECEIVED FROM THE SOURCE. Y = LATEST VERSION OF THE RECORD N = PREVIOUS VERSION OF THE RECORD
                PRVDR_ENRLMT_ASCTN_TRMNTN_DT, -- DATE: A DATE INDICATING THE TERMINATION DATE OF THE ENROLLMENT ASSOCIATION IN THE PROVIDER ENROLLMENT, CHAIN AND OWNERSHIP SYSTEM (PECOS).
                IDR_DRVD_ASCTN_TRMNTN_DT_SW, -- TEXT(1): AN INDICATOR THAT IDENTIFIES IF THE INTEGRATED DATA REPOSITORY (IDR) DERIVED THE ENROLLMENT ASSOCIATION TERMINATION DATE. IF OVERLAPPING DATES ARE RECEIVED FROM THE PROVIDER ENROLLMENT, CHAIN, AND OWNERSHIP SYSTEM (PECOS) SOURCE SYSTEM, THE IDR WILL DERIVE THE END DATE SO NO DATES OVERLAP. OR, IF THERE ARE TWO OR MORE ROWS THAT CONTAIN A DIFFERENT END DATE, THE IDR WILL USE THE MOST RECENT EXPIRATION DATE FOR THAT PRIMARY KEY.
                ENRLMT_ASCTN_TYPE_CD, -- TEXT(1): A CODE INDICATING THE PROVIDER'S OR SUPPLIER'S ASSOCIATION TYPE IN THE PROVIDER ENROLLMENT, CHAIN, AND OWNERSHIP SYSTEM (PECOS). VALID VALUES: I = INDIVIDUAL O = ORGANIZATION
                ENRLMT_ASCTN_TYPE_DESC, -- TEXT(24): A DESCRIPTION OF A CODE INDICATING THE PROVIDER'S OR SUPPLIER'S ASSOCIATION TYPE IN THE PROVIDER ENROLLMENT, CHAIN, AND OWNERSHIP SYSTEM (PECOS).
                PRVDR_ENRLMT_ASCTN_AFLTN_CD, -- TEXT(2): A CODE INDICATING THE PROVIDER'S OR SUPPLIER'S ASSOCIATION AFFILIATION IN THE PROVIDER ENROLLMENT, CHAIN AND OWNERSHIP SYSTEM (PECOS).
                PRVDR_ENRLMT_ASCTN_AFLTN_DESC, -- TEXT(100): A DESCRIPTION OF A CODE INDICATING THE PROVIDER'S OR SUPPLIERS ASSOCIATION AFFILIATION IN THE PROVIDER ENROLLMENT, CHAIN AND OWNERSHIP SYSTEM (PECOS).
                ENRLMT_ASCTN_OWNRSHP_ACQR_BUY_SW, -- TEXT(1): A CODE INDICATING IF THE ORGANIZATION WAS SOLELY CREATED TO ACQUIRE/BUY THE PROVIDER AND/OR THE PROVIDER'S ASSETS. VALID VALUES: Y = ORGANIZATION CREATED SOLELY TO ACQUIRE/BUY THE PROVIDER AND/OR PROVIDER'S ASSETS. N = ORGANIZATION NOT CREATED SOLELY TO ACQUIRE/BUY THE PROVIDER AND/OR PROVIDER'S ASSETS.
                ENRLMT_ASCTN_OWNRSHP_CNTRCT_SRVCS_TXT, -- TEXT(500): A TEXT DESCRIPTION OF THE PROVIDER'S CONTRACTED SERVICES. FOR EXAMPLE 100% MANAGERIAL, CHAIN HOME OFFICE, SYSTEM OFFICE SERVICES, ETC.
                ENRLMT_ASCTN_OWNRSHP_PCTG_NUM, -- NUMBER(38): THE PERCENTAGE OF OWNERSHIP FOR THE ASSOCIATION ENTITY. FOR EXAMPLE 10, 50, 100.
                ENRLMT_ASCTN_OWNRSHP_TITLE_TXT, -- TEXT(50): A TEXT DESCRIPTION OF THE PROVIDER'S OWNERSHIP TITLE. FOR EXAMPLE BOARD MEMBER, DIRECTOR OF NURSING, ETC.
                IDR_INSRT_TS, -- TIMESTAMP_NTZ: THE SYSTEM DATE AND TIME ASSIGNED BY THE INTEGRATED DATA REPOSITORY (IDR) WHILE PERFORMING AN INSERT OPERATION.
                IDR_UPDT_TS, -- TIMESTAMP_NTZ: THE SYSTEM DATE AND TIME ASSIGNED BY THE INTEGRATED DATA REPOSITORY (IDR) WHEN UPDATES ARE MADE TO ANY NON-PRIMARY KEY COLUMN.
                META_SRC_SK, -- NUMBER(38): A UNIQUE NUMERIC VALUE ASSIGNED BY THE INTEGRATED DATA REPOSITORY (IDR) USED TO IDENTIFY THE SPECIFIC SOURCE OF THE DATA WHEN A ROW IS LOADED INTO THE IDR.REFERENCE TABLE: V2_MDCR_META_DCTNRY_SRC
                META_SRC_PRCSG_ID, -- NUMBER(38): A VALUE ASSIGNED BASED ON A BATCH IDENTIFICATION IN ORDER TO TRACE IT BACK TO ITS ORIGINAL SOURCE. IT WILL ONLY BE POPULATED WHEN A RECORD IS INSERTED.
                META_LTST_SRC_PRCSG_ID -- NUMBER(38): A VALUE ASSIGNED BASED ON A BATCH IDENTIFICATION IN ORDER TO TRACE IT BACK TO ITS ORIGINAL SOURCE. IT WILL ONLY BE POPULATED WHEN A RECORD IS SUBSEQUENTLY UPDATED.
            FROM IDRC_PRD.CMS_VDM_VIEW_MDCR_PRD.V2_PRVDR_ENRLMT_ASCTN_HSTRY"""


if __name__ == '__main__':
    # Execute the export using the IDROutputter framework
    exporter = V2PrvdrEnrlmtAsctnHstryExporter()
    exporter.do_idr_output()

# To download use: 
# snowsql -c cms_idr -q "GET @~/ file://. PATTERN='.*.csv';"
# Or look in ../misc_scripts/ for download_and_merge_all_snowflake_csv.sh
