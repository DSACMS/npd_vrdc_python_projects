"""
==========
V2_PRVDR_ENRLMT_CRNT IDR Export (Auto-Generated)
==========

Auto-generated IDROutputter implementation for IDRC_PRD.CMS_VDM_VIEW_MDCR_PRD.V2_PRVDR_ENRLMT_CRNT

Table Type: VIEW
Columns: 26
Generated: 2025-11-04 00:46:08
Source Pattern: %PRVDR_ENRLMT%

This script provides a complete IDROutputter subclass that exports all columns
from the table in their original Snowflake order. You can customize the
getSelectQuery() method to add WHERE clauses, JOINs, or modify column selection.

Usage:
    # In a Snowflake notebook environment:
    exporter = V2PrvdrEnrlmtCrntExporter()
    exporter.do_idr_output()
"""

# Import python packages
import pandas as pd
from datetime import datetime

# Import the IDROutputter base class
try:
    from IDROutputter import IDROutputter
except ImportError:
    print("Loading IDROutputter from previous cell or add proper import path")


class V2PrvdrEnrlmtCrntExporter(IDROutputter):
    """
    Exports V2_PRVDR_ENRLMT_CRNT data using IDROutputter base class.
    
    Auto-generated from table metadata. Customize as needed for your specific requirements.
    
    Table: IDRC_PRD.CMS_VDM_VIEW_MDCR_PRD.V2_PRVDR_ENRLMT_CRNT (VIEW)
    Columns: 26
    """
    
    # Class properties
    version_number: str = "v01"
    file_name_stub: str = "v2_prvdr_enrlmt_crnt_idr_export"
    
    def getSelectQuery(self) -> str:
        """
        Returns the SELECT query for V2_PRVDR_ENRLMT_CRNT export.
        
        Includes all 26 columns in their original Snowflake order.
        Customize this method to add WHERE clauses, JOINs, or modify column selection.
        """
        return """SELECT
                PRVDR_ENRLMT_ID, -- TEXT(15): A UNIQUE VALUE GENERATED BY THE PROVIDER ENROLLMENT, CHAIN AND OWNERSHIP SYSTEM (PECOS) TO IDENTIFY A PROVIDER'S ENROLLMENT APPLICATION. ALL ENROLLMENT-LEVEL INFORMATION (E.G., ENROLLMENT TYPE, ENROLLMENT STATE, PROVIDER SPECIALTY AND REASSIGNMENT OF BENEFITS) IS LINKED THROUGH THE ENROLLMENT ID.
                PRVDR_PAC_ID, -- TEXT(10): A UNIQUE NUMERIC IDENTIFIER THAT IS ASSIGNED TO EACH INDIVIDUAL OR NORGANIZATION IN PROVIDER ENROLLMENT, CHAIN AND OWNERSHIP SYSTEM (PECOS). ALL ENTITY-LEVEL INFORMATION (E.G., TAX IDENTIFICATION NUMBERS NAND ORGANIZATIONAL NAMES) IS LINKED THROUGH THE PAC ID. A PAC ID MAY BE ASSOCIATED NWITH MULTIPLE ENROLLMENT IDS IF THE INDIVIDUAL OR ORGANIZATION ENROLLED MULTIPLE TIMES NUNDER DIFFERENT CIRCUMSTANCES
                PRVDR_ENRLMT_STATE_CD, -- TEXT(2): A UNIQUE CODE THAT IDENTIFIES A STATE FOR THE MEDICARE CONTRACTOR THAT CREATED THE ENROLLMENT IN THE PROVIDER ENROLLMENT, CHAIN AND OWNERSHIP SYSTEM (PECOS).NNREFERENCE TABLE: GEO_USPS_STATE_CD
                PRVDR_ENRLMT_FORM_CD, -- TEXT(10): CASENN    WHEN ROLE_CD = '00' THEN '855A' -- INSTITUTIONAL PROVIDERNN    WHEN ROLE_CD = '12' THEN '855B' -- CLINICS, GROUP PRACTICES, AND CERTAIN OTHER SUPPLIERSNN    WHEN ROLE_CD = '14' THEN '855I' -- INDIVIDUALS (PHYSICIANS AND NON-PHYSICIANS)   NN    WHEN ROLE_CD = '30' THEN '855S' -- DMEPOS SUPPLIERNN    WHEN ROLE_CD = '33' THEN '855O' -- ORDERING AND CERTIFYING PHYSICIANS AND NON-PHYSICIAN PRACTIONERS NN    WHEN ROLE_CD = '52' THEN '855X' -- IPP (INDIRECT PAYMENT PROCEDURE OR INTERPROFESSIONAL PRACTICE) BILLERNN    WHEN ROLE_CD = '53' THEN '20134' -- MDPP (MEDICARE DIABETES PREVENTION PROGRAM SUPPLIER)NNEND PRVDR_ENRLMT_FORM_CDN N
                CLM_CNTRCTR_NUM, -- TEXT(5): A NUMBER ASSIGNED BY CENTERS FOR MEDICARE AND MEDICAID SERVICES (CMS) IDENTIFYING A MEDICARE ADMINISTRATIVE CONTRACTOR (MAC) AUTHORIZED TO PROCESS MEDICARE CLAIMS.NNREFERENCE TABLE: CLM_CNTRCTR_NUMN
                PRVDR_ENRLMT_INITL_DT, -- DATE: A DATE IDENTIFYING WHEN THE PROVIDER ENROLLMENT CHAIN AND OWNERSHIP SYSTEM (PECOS) ASSOCIATE FIRST ENROLLED TO BILL MEDICARE.
                PRVDR_ENRLMT_PRPRTR_NPRFT_CD, -- TEXT(1): AN CODE THAT THE BUSINESS IS REGISTERED AS PROPRIETOR OR NON-PROFIT WITH THE IRS:NP - PROPRIETOR NN - NONPROFITND - DISREGARDED ENTITY
                PRVDR_ENRLMT_INCORPTN_DT, -- DATE: A DATE ON WHICH THE BUSINESS IS INCORPORATED.
                PRVDR_ENRLMT_INCORPTN_STATE_CD, -- TEXT(2): THE STATE IN WHICH THE BUSINESS IS INCORPORATED.NNREFERENCE TABLE: GEO_USPS_STATE_CDN
                PRVDR_ENRLMT_ORG_TYPE_STRUC_CD, -- TEXT(1): A CODE IDENTIFYING THE ORGANIZATION STRUCTURE TYPE FOR A PROVIDER WHO HAS ENROLLED IN THE PROVIDER ENROLLMENT, CHAIN AND OWNERSHIP SYSTEM (PECOS).NNREFERENCE TABLE:NENRLMT_ORG_TYPE_STRUC_CD
                PRVDR_ENRLMT_ORG_TYPE_STRUC_DESC, -- TEXT(1000): A CODE IDENTIFYING THE ORGANIZATION STRUCTURE TYPE FOR A PROVIDER WHO HAS ENROLLED IN THE PROVIDER ENROLLMENT, CHAIN AND OWNERSHIP SYSTEM (PECOS).NNREFERENCE TABLE:NENRLMT_ORG_TYPE_STRUC_CD
                PRVDR_ENRLMT_ORG_STRUC_OTHR_TXT, -- TEXT(75): A DESCRIPTION OF THE ORGANIZATION TYPE IF THE PROVIDER ORGANIZATION STRUCTURE TYPE CODE INDICATES "OTHER".
                PRVDR_ENRLMT_CNTCT_DT, -- DATE: A DATE CONTACT TOOK PLACE FOR THE SPECIFIED REASON CODE. VALID REASON CODES REPRESENT FIRST CONTACT, SECOND CONTACT, THIRD CONTACT, ETC.
                PRVDR_ENRLMT_FLNY_DT, -- DATE: A FELONY DATE FOR THE REVOKED STATUS OF THE ENROLLMENT.
                PRVDR_ENRLMT_CMT_TXT, -- TEXT(5000): A COMMENT ABOUT ANY UNIQUE OR UNUSUAL CIRCUMSTANCES CONCERNING THE MEDICARE ENROLLMENT IN THE PROVIDER ENROLLMENT CHAIN AND OWNERSHIP SYSTEM (PECOS).
                PRVDR_ENRLMT_STUS_BGN_TS, -- TIMESTAMP_NTZ: DATE AND TIME THE VERSION OF THE ENROLLMENT STATUS RECORD
                PRVDR_ENRLMT_STUS_CD, -- TEXT(2): A CODE INDICATING THE PROVIDER'S ENROLLMENT STATUS IN THE PROVIDER ENROLLMENT, CHAIN AND OWNERSHIP SYSTEM (PECOS).NNREFERENCE TABLE:  PRVDR_ENRLMT_STUS_CD
                PRVDR_ENRLMT_STUS_DESC, -- TEXT(1000): A CODE INDICATING THE PROVIDER'S ENROLLMENT STATUS IN THE PROVIDER ENROLLMENT, CHAIN AND OWNERSHIP SYSTEM (PECOS).NNREFERENCE TABLE:  PRVDR_ENRLMT_STUS_CD
                PRVDR_ENRLMT_LST_STUS_RSN_TS, -- TIMESTAMP_NTZ: THE DATE AND TIME OF WHICH THE STATUS RECORD WAS UPDATED IN PROVIDER PROVIDER ENROLLMENT, CHAIN, AND OWNERSHIP SYSTEM (PECOS) SOURCE SYSTEM.
                PRVDR_ENRLMT_STUS_LST_RSN_CD, -- TEXT(3): A CODE INDICATING THE REASON FOR THE PROVIDER'S ENROLLMENT STATUS IN THE PROVIDER ENROLLMENT, CHAIN AND OWNERSHIP SYSTEM (PECOS).NNREFERENCE TABLE:  PRVDR_RSN_CD
                PRVDR_ENRLMT_STUS_LST_RSN_DESC, -- TEXT(1000): A CODE INDICATING THE REASON FOR THE PROVIDER'S ENROLLMENT STATUS IN THE PROVIDER ENROLLMENT, CHAIN AND OWNERSHIP SYSTEM (PECOS).NNREFERENCE TABLE:  PRVDR_RSN_CD
                PRVDR_ENRLMT_PRMRY_SPCLTY_CD, -- TEXT(2): A CODE IDENTIFYING THE CENTERS FOR MEDICARE AND MEDICAID SERVICES (CMS) SPECIALTY OF A PROVIDER OR SUPPLIER.NREFERENCE TABLE: PRVDR_PECOS_ENRLMT_SPCLTY_CD
                PRVDR_ENRLMT_PRMRY_SPCLTY_DESC, -- TEXT(1000): A DESCRIPTION OF A PROVIDER SPECIALTY CODE VALUE.
                PRVDR_ENRLMT_PRMRY_SPCLTY_EFCTV_DT, -- DATE: DATE THE SPECIALTY BECAME EFFECTIVE.
                PRVDR_ENRLMT_PRMRY_SPCLTY_TRMNTN_DT, -- DATE: THE TERMINATION DATE OF THE SPECIALTY.
                META_SRC_SK -- NUMBER(38): A UNIQUE NUMERIC VALUE ASSIGNED BY THE INTEGRATED DATA REPOSITORY (IDR) USED TO IDENTIFY THE SPECIFIC SOURCE OF THE DATA WHEN A ROW IS LOADED INTO THE IDR.NNREFERENCE TABLE: V2_MDCR_META_DCTNRY_SRC
            FROM IDRC_PRD.CMS_VDM_VIEW_MDCR_PRD.V2_PRVDR_ENRLMT_CRNT"""


if __name__ == '__main__':
    # Execute the export using the IDROutputter framework
    exporter = V2PrvdrEnrlmtCrntExporter()
    exporter.do_idr_output()

# To download use: 
# snowsql -c cms_idr -q "GET @~/ file://. PATTERN='.*.csv';"
# Or look in ../misc_scripts/ for download_and_merge_all_snowflake_csv.sh
