"""
==========
V2_PRVDR_ENRLMT_BLG_TIN_CRNT IDR Export (Auto-Generated)
==========

Auto-generated IDROutputter implementation for IDRC_PRD.CMS_VDM_VIEW_MDCR_PRD.V2_PRVDR_ENRLMT_BLG_TIN_CRNT

Table Type: VIEW
Columns: 18
Generated: 2025-11-04 01:29:56
Source Pattern: %PRVDR_ENRLMT%

This script provides a complete IDROutputter subclass that exports all columns
from the table in their original Snowflake order. You can customize the
getSelectQuery() method to add WHERE clauses, JOINs, or modify column selection.

Usage:
    # In a Snowflake notebook environment:
    exporter = V2PrvdrEnrlmtBlgTinCrntExporter()
    exporter.do_idr_output()
"""

# Import python packages
import pandas as pd
from datetime import datetime

# Import the IDROutputter base class
try:
    from IDROutputter import IDROutputter
except ImportError:
    print("Loading IDROutputter from previous cell or add proper import path")


class V2PrvdrEnrlmtBlgTinCrntExporter(IDROutputter):
    """
    Exports V2_PRVDR_ENRLMT_BLG_TIN_CRNT data using IDROutputter base class.
    
    Auto-generated from table metadata. Customize as needed for your specific requirements.
    
    Table: IDRC_PRD.CMS_VDM_VIEW_MDCR_PRD.V2_PRVDR_ENRLMT_BLG_TIN_CRNT (VIEW)
    Columns: 18
    """
    
    # Class properties
    version_number: str = "v01"
    file_name_stub: str = "v2_prvdr_enrlmt_blg_tin_crnt_idr_export"
    
    def getSelectQuery(self) -> str:
        """
        Returns the SELECT query for V2_PRVDR_ENRLMT_BLG_TIN_CRNT export.
        
        Includes all 18 columns in their original Snowflake order.
        Customize this method to add WHERE clauses, JOINs, or modify column selection.
        """
        return """SELECT
                PRVDR_ENRLMT_ID, -- TEXT(15): A UNIQUE VALUE GENERATED BY THE PROVIDER ENROLLMENT, CHAIN AND OWNERSHIP SYSTEM (PECOS) TO IDENTIFY A PROVIDER'S ENROLLMENT APPLICATION. ALL ENROLLMENT-LEVEL INFORMATION (E.G., ENROLLMENT TYPE, ENROLLMENT STATE, PROVIDER SPECIALTY AND REASSIGNMENT OF BENEFITS) IS LINKED THROUGH THE ENROLLMENT ID.
                PRVDR_ENRLMT_BLG_TIN_NUM, -- TEXT(9): AN IDENTIFYING NUMBER FOR THE BILLING PROVIDER USED FOR TAX PURPOSES IN THE UNITED STATES AND ASSIGNED BY THE INTERNAL REVENUE SERVICE (IRS). THE IRS ASSIGNS A TAXPAYER IDENTIFICATION NUMBER (TIN) TO INDIVIDUALS OR AN EMPLOYER IDENTIFICATION NUMBER (EIN) TO EMPLOYERS.
                PRVDR_ENRLMT_TIN_EFCTV_DT, -- DATE: DATE THE PROVIDER TAXPAYER IDENTIFICATION NUMBER (TIN) WAS ASSOCIATED WITH THE PROVIDER ENROLLMENT, CHAIN, AND OWNERSHIP SYSTEM (PECOS) ASSOCIATE.
                PRVDR_ENRLMT_TIN_TRMNTN_DT, -- DATE: DATE THE PROVIDER TAXPAYER IDENTIFICATION NUMBER (TIN) CAN NO LONGER BE ASSOCIATED WITH THE PROVIDER ENROLLMENT, CHAIN, AND OWNERSHIP SYSTEM (PECOS) ASSOCIATE'S APPLICATION.
                IDR_DRVD_ENRLMT_TIN_TRMNTN_DT_SW, -- TEXT(1): AN INDICATOR THAT IDENTIFIES IF THE INTEGRATED DATA REPOSITORY (IDR) DERIVED THE PROVIDER TAXPAYER IDENTIFICATION NUMBER (TIN) END DATE. IF OVERLAPPING DATES ARE RECEIVED FROM THE PROVIDER ENROLLMENT, CHAIN, AND OWNERSHIP SYSTEM (PECOS) SOURCE SYSTEM, THE IDR WILL DERIVE THE END DATE SO NO DATES OVERLAP. OR, IF THERE ARE TWO OR MORE ROWS THAT CONTAIN A DIFFERENT END DATE, THE IDR WILL USE THE MOST RECENT EXPIRATION DATE FOR THAT PRIMARY KEY. VALID VALUES: Y = PROVIDER TIN END DATE IS DERIVED N = PROVIDER TIN END DATE IS NOT DERIVED
                PRVDR_TIN_TYPE_CD, -- TEXT(1): A CODE IDENTIFYING THE BILLING TAXPAYER IDENTIFICATION TYPE FOR A PROVIDER WHO HAS ENROLLED IN THE PROVIDER ENROLLMENT, CHAIN, AND OWNERSHIP SYSTEM (PECOS). VALID VALUES: E = EMPLOYEE IDENTIFICATION NUMBER S = SOCIAL SECURITY NUMBER
                PRVDR_ENRLMT_BLG_TIN_STRUC_CD, -- TEXT(2): A CODE IDENTIFYING THE BILLING TAXPAYER IDENTIFICATION STRUCTURE TYPE FOR A PROVIDER WHO HAS ENROLLED IN THE PROVIDER ENROLLMENT, CHAIN, AND OWNERSHIP SYSTEM (PECOS). VALID VALUES: D = DISREGARDED ENTITY S = SOLE PROPRIETOR REFERENCE TABLE: PRVDR_PECOS_ENRLMT_ORG_TYPE_STRUC_CD
                PRVDR_ENRLMT_BLG_TIN_STRUC_DESC, -- TEXT(1000): THE DESCRIPTION OF THE CODE IDENTIFYING THE ORGANIZATION STRUCTURE TYPE FOR A PROVIDER WHO HAS ENROLLED IN THE PROVIDER ENROLLMENT, CHAIN AND OWNERSHIP SYSTEM (PECOS).
                PRVDR_ORG_NAME, -- TEXT(100): AN OFFICIAL NAME UNDER WHICH A BUSINESS OPERATES AND HOLDS ITSELF OUT TO THE PUBLIC.
                NAME_TYPE_CD, -- TEXT(2): A CODE IDENTIFYING ANOTHER TYPE OF NAME USED. REFERENCE TABLE: NAME_TYPE_CD
                NAME_TYPE_DESC, -- TEXT(500): A DESCRIPTION OF A CODE IDENTIFYING ANOTHER TYPE OF NAME USED.
                NAME_ROLE_CD, -- TEXT(2): AN INTEGRATED DATA REPOSITORY (IDR) DERIVED CODE IDENTIFYING THE ROLE TYPE FOR A NAME SENT. REFERENCE TABLE: NAME_ROLE_CD
                NAME_ROLE_DESC, -- TEXT(500): A DESCRIPTION OF A CODE IDENTIFYING THE ROLE TYPE FOR A NAME SENT.
                IDR_INSRT_TS, -- TIMESTAMP_NTZ: THE SYSTEM DATE AND TIME ASSIGNED BY THE INTEGRATED DATA REPOSITORY (IDR) WHILE PERFORMING AN INSERT OPERATION.
                IDR_UPDT_TS, -- TIMESTAMP_NTZ: THE SYSTEM DATE AND TIME ASSIGNED BY THE INTEGRATED DATA REPOSITORY (IDR) WHEN UPDATES ARE MADE TO ANY NON-PRIMARY KEY COLUMN.
                META_SRC_SK, -- NUMBER(38): A UNIQUE NUMERIC VALUE ASSIGNED BY THE INTEGRATED DATA REPOSITORY (IDR) USED TO IDENTIFY THE SPECIFIC SOURCE OF THE DATA WHEN A ROW IS LOADED INTO THE IDR. REFERENCE TABLE: V2_MDCR_META_DCTNRY_SRC
                META_SRC_PRCSG_ID, -- NUMBER(38): A VALUE ASSIGNED BASED ON A BATCH IDENTIFICATION IN ORDER TO TRACE IT BACK TO ITS ORIGINAL SOURCE. IT WILL ONLY BE POPULATED WHEN A RECORD IS INSERTED.
                META_LTST_SRC_PRCSG_ID -- NUMBER(38): A VALUE ASSIGNED BASED ON A BATCH IDENTIFICATION IN ORDER TO TRACE IT BACK TO ITS ORIGINAL SOURCE. IT WILL ONLY BE POPULATED WHEN A RECORD IS SUBSEQUENTLY UPDATED.
            FROM IDRC_PRD.CMS_VDM_VIEW_MDCR_PRD.V2_PRVDR_ENRLMT_BLG_TIN_CRNT"""


if __name__ == '__main__':
    # Execute the export using the IDROutputter framework
    exporter = V2PrvdrEnrlmtBlgTinCrntExporter()
    exporter.do_idr_output()

# To download use: 
# snowsql -c cms_idr -q "GET @~/ file://. PATTERN='.*.csv';"
# Or look in ../misc_scripts/ for download_and_merge_all_snowflake_csv.sh
