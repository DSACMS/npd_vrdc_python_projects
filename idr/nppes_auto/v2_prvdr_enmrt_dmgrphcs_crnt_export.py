"""
==========
V2_PRVDR_ENMRT_DMGRPHCS_CRNT IDR Export (Auto-Generated)
==========

Auto-generated IDROutputter implementation for IDRC_PRD.CMS_VDM_VIEW_MDCR_PRD.V2_PRVDR_ENMRT_DMGRPHCS_CRNT

Table Type: VIEW
Columns: 50
Generated: 2025-11-04 01:30:17
Source Pattern: %PRVDR_ENMRT%

This script provides a complete IDROutputter subclass that exports all columns
from the table in their original Snowflake order. You can customize the
getSelectQuery() method to add WHERE clauses, JOINs, or modify column selection.

Usage:
    # In a Snowflake notebook environment:
    exporter = V2PrvdrEnmrtDmgrphcsCrntExporter()
    exporter.do_idr_output()
"""

# Import python packages
import pandas as pd
from datetime import datetime

# Import the IDROutputter base class
try:
    from IDROutputter import IDROutputter
except ImportError:
    print("Loading IDROutputter from previous cell or add proper import path")


class V2PrvdrEnmrtDmgrphcsCrntExporter(IDROutputter):
    """
    Exports V2_PRVDR_ENMRT_DMGRPHCS_CRNT data using IDROutputter base class.
    
    Auto-generated from table metadata. Customize as needed for your specific requirements.
    
    Table: IDRC_PRD.CMS_VDM_VIEW_MDCR_PRD.V2_PRVDR_ENMRT_DMGRPHCS_CRNT (VIEW)
    Columns: 50
    """
    
    # Class properties
    version_number: str = "v01"
    file_name_stub: str = "v2_prvdr_enmrt_dmgrphcs_crnt_idr_export"
    
    def getSelectQuery(self) -> str:
        """
        Returns the SELECT query for V2_PRVDR_ENMRT_DMGRPHCS_CRNT export.
        
        Includes all 50 columns in their original Snowflake order.
        Customize this method to add WHERE clauses, JOINs, or modify column selection.
        """
        return """SELECT
                PRVDR_NPI_NUM, -- TEXT(10): A NATIONAL PROVIDER IDENTIFIER (NPI) UNIQUELY ASSIGNED FOR COVERED HEALTH CARE PROVIDERS.
                PRVDR_ENT_TYPE_CD, -- TEXT(1): A CODE THAT IDENTIFIES THE PROVIDER'S BUSINESS STRUCTURE. VALID VALUES: '1' = INDIVIDUAL '2' = ORGANIZATION
                PRVDR_ENT_TYPE_DESC, -- TEXT(12): DESCRIPTION OF THE ENTITY TYPE CODE. THE PROVIDER'S BUSINESS STRUCTURE IS EITHER AN INDIVIDUAL OR AN ORGANIZATION.
                PRVDR_CRTFCTN_DT, -- DATE: THE DATE THE PROVIDER CERTIFIED THAT ALL INFORMATION RELATED TO THE NATIONAL PROVIDER IDENTIFIER (NPI) RECORD IS ACCURATE AND UP-TO-DATE.
                PRVDR_RPLCMT_NPI_NUM, -- TEXT(10): A REPLACEMENT NATIONAL PROVIDER IDENTIFIER (NPI) UNIQUELY ASSIGNED FOR A COVERED HEALTH CARE PROVIDER. THIS IS THE PROVIDERâ€™S NPI IF THE PROVIDER HAS BEEN ASSIGNED A REPLACEMENT NPI. IF THE PROVIDER HAS NEVER BEEN ASSIGNED A REPLACEMENT NPI, THIS DATA ELEMENT WILL NOT BE POPULATED.
                PRVDR_SSN_NUM, -- TEXT(9): A NUMBER ASSIGNED BY THE SOCIAL SECURITY ADMINISTRATION (SSA) USED TO IDENTIFY AN INDIVIDUAL.
                PRVDR_TIN_NUM, -- TEXT(9): AN IDENTIFYING NUMBER USED FOR TAX PURPOSES IN THE UNITED STATES AND ASSIGNED BY THE INTERNAL REVENUE SERVICE (IRS). THE IRS ASSIGNS A TAX IDENTIFICATION NUMBER (TIN) TO INDIVIDUALS OR AN EMPLOYER IDENTIFICATION NUMBER (EIN) TO EMPLOYERS.
                PRVDR_EIN_NUM, -- TEXT(9): AN IDENTIFYING NUMBER USED FOR TAX PURPOSES IN THE UNITED STATES AND ASSIGNED BY THE INTERNAL REVENUE SERVICE (IRS). THE IRS ASSIGNS A TAX IDENTIFICATION NUMBER (TIN) TO INDIVIDUALS OR AN EMPLOYER IDENTIFICATION NUMBER (EIN) TO EMPLOYERS.
                PRVDR_ENMRTN_DT, -- DATE: THE DATE THE NATIONAL PROVIDER IDENTIFIER (NPI) WAS ASSIGNED.
                PRVDR_LAST_UPDT_DT, -- DATE: A DATE INDICATING THE LAST TIME THE PROVIDER RECORD WAS UPDATED IN THE NATIONAL PLAN AND PROVIDER ENUMERATION SYSTEM (NPPES).
                PRVDR_DEACTVTN_RSN_CD, -- TEXT(2): A CODE REPRESENTING THE REASON THE NATIONAL PLAN AND PROVIDER ENUMERATION SYSTEM (NPPES) DEACTIVATED A PROVIDER RECORD. REFERENCE TABLE: PRVDR_DEACTVTN_RSN_CD
                PRVDR_DEACTVTN_RSN_DESC, -- TEXT(500): A DESCRIPTION OF A CODE IDENTIFYING THE REASON THE NATIONAL PLAN AND PROVIDER ENUMERATION SYSTEM (NPPES) DEACTIVATED A PROVIDER ENUMERATION RECORD.
                PRVDR_DEACTVTN_DT, -- DATE: A DATE INDICATING WHEN THE PROVIDER WAS DEACTIVATED.
                PRVDR_REACTVTN_DT, -- DATE: A DATE INDICATING WHEN THE PROVIDER WAS REACTIVATE.
                PRVDR_GNDR_CD, -- TEXT(1): AN IDENTIFIER DESCRIBING THE SEX OF THE PROVIDER. VALID VALUES: 'M' = MALE 'F' = FEMALE
                PRVDR_BIRTH_DT, -- DATE: A DATE OF BIRTH OF A PROVIDER.
                PRVDR_BIRTH_USPS_STATE_CD, -- TEXT(2): A CODE IDENTIFYING THE TWO-CHARACTER UNITED STATES POSTAL SERVICE (USPS) ALPHABETIC ABBREVIATION FOR THE STATE THE PROVIDER WAS BORN IN. REFERENCE TABLE: GEO_USPS_STATE_CD
                PRVDR_BIRTH_CNTRY_CD, -- TEXT(2): A TWO-CHARACTER ALPHABETIC ABBREVIATION OF THE COUNTRY WHERE THE HEALTH CARE PROVIDER WAS BORN. IT WILL ONLY BE POPULATED FOR INDIVIDUAL PROVIDERS (PROVIDER ENTITY TYPE CODE = 1). REFERENCE TABLE: GEO_CNTRY_CD
                PRVDR_SOLE_PRPRTR_CD, -- TEXT(1): A CODE INDICATING IF A TYPE 1 PROVIDER (INDIVIDUAL) IS THE SOLE PROPRIETOR. VALID VALUES: Y = YES, ENTITY TYPE 1 PROVIDER (INDIVIDUAL) IS A SOLE PROPRIETOR N = NO, ENTITY TYPE 1 PROVIDER (INDIVIDUAL) IS NOT A SOLE PROPRIETOR X = NOT ANSWERED
                PRVDR_ORG_SUBRDNT_CD, -- TEXT(1): A CODE IDENTIFYING IF A PROVIDER IS A SUBPART OF A HEALTH CARE ORGANIZATION (I.E., ENTITY TYPE 2). VALID VALUES: Y = YES, ENTITY TYPE 2 PROVIDER (ORGANIZATION) IS A SUBPART N = NO, ENTITY TYPE 2 PROVIDER (ORGANIZATION) IS NOT A SUBPART X = NOT ANSWERED
                PRVDR_PRNT_ORG_TIN_NUM, -- TEXT(9): A UNIQUE TAX IDENTIFIER ASSIGNED TO A HEALTH CARE PROVIDER BY SOCIAL SECURITY ADMINISTRATION (SSA) OR THE INTERNAL REVENUE SERVICE (IRS).
                PRVDR_PREX_NAME, -- TEXT(20): PROVIDER NAME PREFIX TEXT;PROVIDER OTHER NAME PREFIX TEXT;AUTHORIZED OFFICIAL NAME PREFIX TEXT;CONTACT PERSON NAME PREFIX TEXT
                PRVDR_1ST_NAME, -- TEXT(35): A FIRST NAME OF A PROVIDER.
                PRVDR_MDL_NAME, -- TEXT(20): AN OFFICIAL NAME UNDER WHICH A BUSINESS OPERATES AND HOLDS ITSELF OUT TO THE PUBLIC.
                PRVDR_LAST_NAME, -- TEXT(35): A SURNAME OF THE INDIVIDUAL.
                PRVDR_SFX_NAME, -- TEXT(20): AN IDENTIFIER OF A PHRASE AT THE END OF A NAME THAT FURTHER DESCRIBES AN INDIVIDUAL, E.G.'JR', 'SR', ETC.
                ORG_NAME, -- TEXT(100): AN OFFICIAL NAME UNDER WHICH A BUSINESS OPERATES AND HOLDS ITSELF OUT TO THE PUBLIC.
                MLG_LINE_1_ADR, -- TEXT(55): A FIRST LINE OF AN ADDRESS ASSOCIATED WITH A BENEFICIARY, PROVIDER, OR CLAIM.
                MLG_LINE_2_ADR, -- TEXT(55): A SECOND LINE OF AN ADDRESS ASSOCIATED WITH A BENEFICIARY, PROVIDER, OR CLAIM. THIS ADDRESS LINE IS OPTIONAL AND USED TO INDICATE THE POST OFFICE BOX, SUITE NUMBER, APARTMENT NUMBER, ETC.
                MLG_ADR_CITY_NAME, -- TEXT(40): A NAME OF THE CITY ASSOCIATED WITH A FIVE-DIGIT ZIP CODE DEFINED BY THE UNITED STATES POSTAL SERVICE (USPS).
                MLG_GEO_USPS_STATE_CD, -- TEXT(2): A CODE IDENTIFYING A TWO-CHARACTER ALPHABETIC ABBREVIATION FOR A STATE IN THE UNITED STATES AS DEFINED BY UNITED STATES POSTAL SERVICE (USPS) ASSOCIATED WITH A BENEFICIARY, PROVIDER, OR CLAIM ADDRESS. REFERENCE TABLE: GEO_USPS_STATE_CD
                MLG_GEO_ZIP5_CD, -- TEXT(5): A FIVE-DIGIT ZIP CODE DEFINED BY THE UNITED STATES POSTAL SERVICE (USPS) THAT IDENTIFIES A DESTINATION POST OFFICE OR DELIVERY AREA ASSOCIATED WITH A BENEFICIARY, PROVIDER, OR CLAIM ADDRESS. REFERENCE TABLE: GEO_ZIP5_CD
                MLG_GEO_ZIP4_CD, -- TEXT(4): A FOUR-DIGIT ZIP CODE EXTENSION DEFINED BY THE UNITED STATES POSTAL SERVICE (USPS) THAT REPRESENTS A SPECIFIC DELIVERY ROUTE WITHIN A DELIVERY AREA ASSOCIATED WITH A BENEFICIARY, PROVIDER, OR CLAIM ADDRESS. REFERENCE TABLE: GEO_ZIP9_CD
                GEO_MLG_SK, -- NUMBER(38): A NUMERIC SURROGATE KEY THAT IS INDICATIVE OF A PARTICULAR GEOGRAPHICAL LOCATION.
                MLG_CNTRY_CD, -- TEXT(2): A CODE IDENTIFYING A COUNTRY ASSOCIATED WITH A BENEFICIARY, PROVIDER, OR CLAIM ADDRESS AS ASSIGNED BY THE INTERNATIONAL ORGANIZATION FOR STANDARDIZATION (ISO). REFERENCE TABLE: GEO_CNTRY_CD
                MLG_PHNE_NUM, -- TEXT(16777216): A NUMBER THAT REPRESENTS THE TELEPHONE NUMBER OF THE ENTITY OR PERSON.
                MLG_PHNE_EXTNSN_NUM, -- TEXT(16777216): A NUMBER IN ADDITION TO THE TELEPHONE NUMBER OF THE ENTITY OR PERSON.
                MLG_FAX_NUM, -- TEXT(16777216): THE FACSIMILE MACHINE TELEPHONE LINE NUMBER.
                PRCTC_LINE_1_ADR, -- TEXT(55): A NUMBER AND STREET NAME IDENTIFYING WHERE THE ORGANIZATION IS LOCATED.
                PRCTC_LINE_2_ADR, -- TEXT(55): AN ADDITIONAL ADDRESS LINE IDENTIFYING WHERE THE ORGANIZATION IS LOCATED. THIS ADDRESS LINE IS OPTIONAL AND USED TO INDICATE THE POST OFFICE BOX, SUITE NUMBER, APARTMENT NUMBER, ETC.
                PRCTC_ADR_CITY_NAME, -- TEXT(40): A NAME OF THE CITY ASSOCIATED WITH A FIVE-DIGIT ZIP CODE DEFINED BY THE UNITED STATES POSTAL SERVICE (USPS).
                PRCTC_GEO_USPS_STATE_CD, -- TEXT(2): A CODE IDENTIFYING A TWO-CHARACTER ALPHABETIC ABBREVIATION FOR A STATE IN THE UNITED STATES AS DEFINED BY UNITED STATES POSTAL SERVICE (USPS) ASSOCIATED WITH A BENEFICIARY, PROVIDER, OR CLAIM ADDRESS. REFERENCE TABLE: GEO_USPS_STATE_CD
                PRCTC_GEO_ZIP5_CD, -- TEXT(5): A FIVE-DIGIT ZIP CODE DEFINED BY THE UNITED STATES POSTAL SERVICE (USPS) THAT IDENTIFIES THE DESTINATION POST OFFICE OR DELIVERY AREA.
                PRCTC_GEO_ZIP4_CD, -- TEXT(4): A FOUR-DIGIT ZIP CODE EXTENSION DEFINED BY THE UNITED STATES POSTAL SERVICE (USPS) THAT REPRESENTS A SPECIFIC DELIVERY ROUTE WITHIN A DELIVERY AREA ASSOCIATED WITH A BENEFICIARY, PROVIDER, OR CLAIM ADDRESS AND USED IN THE GEOCODING PROCESS. REFERENCE TABLE: GEO_ZIP9_CD
                GEO_PRCTC_SK, -- NUMBER(38): AN INTEGRATED DATA REPOSITORY (IDR) ASSIGNED NUMERIC SURROGATE KEY IDENTIFYING A PARTICULAR GEOGRAPHICAL LOCATION BY ITS FIVE-DIGIT ZIP CODE.
                PRCTC_CNTRY_CD, -- TEXT(2): A TWO-CHARACTER ALPHABETIC ABBREVIATION OF THE COUNTRY ASSOCIATED WITH A BENEFICIARY, PROVIDER, OR CLAIM ADDRESS. REFERENCE TABLE: TBD
                PRCTC_PHNE_NUM, -- TEXT(16777216): A NUMBER THAT REPRESENTS THE TELEPHONE NUMBER OF THE ENTITY OR PERSON.
                PRCTC_PHNE_EXTNSN_NUM, -- TEXT(16777216): A NUMBER IN ADDITION TO THE TELEPHONE NUMBER OF THE ENTITY OR PERSON.
                PRCTC_FAX_NUM, -- TEXT(16777216): THE FACSIMILE MACHINE TELEPHONE LINE NUMBER.
                META_SRC_SK -- NUMBER(38): A UNIQUE NUMERIC VALUE ASSIGNED BY THE INTEGRATED DATA REPOSITORY (IDR) USED TO IDENTIFY THE SPECIFIC SOURCE OF THE DATA WHEN A ROW IS LOADED INTO THE IDR. REFERENCE TABLE: V2_MDCR_META_DCTNRY_SRC
            FROM IDRC_PRD.CMS_VDM_VIEW_MDCR_PRD.V2_PRVDR_ENMRT_DMGRPHCS_CRNT"""


if __name__ == '__main__':
    # Execute the export using the IDROutputter framework
    exporter = V2PrvdrEnmrtDmgrphcsCrntExporter()
    exporter.do_idr_output()

# To download use: 
# snowsql -c cms_idr -q "GET @~/ file://. PATTERN='.*.csv';"
# Or look in ../misc_scripts/ for download_and_merge_all_snowflake_csv.sh
